{% load i18n %}
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>{% trans 'way4day.com — Сеть обмена туристическими впечатлениями' %}</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=1070, initial-scale=1.0">

    {% load staticfiles %}
    {# Favicon: http://realfavicongenerator.net #}
    <link rel="shortcut icon" href="{% static 'favicon/favicon.ico' %}">
    <link rel="apple-touch-icon" sizes="57x57" href="{% static 'favicon/apple-touch-icon-57x57.png' %}">
    <link rel="apple-touch-icon" sizes="114x114" href="{% static 'favicon/apple-touch-icon-114x114.png' %}">
    <link rel="apple-touch-icon" sizes="72x72" href="{% static 'favicon/apple-touch-icon-72x72.png' %}">
    <link rel="apple-touch-icon" sizes="144x144" href="{% static 'favicon/apple-touch-icon-144x144.png' %}">
    <link rel="apple-touch-icon" sizes="60x60" href="{% static 'favicon/apple-touch-icon-60x60.png' %}">
    <link rel="apple-touch-icon" sizes="120x120" href="{% static 'favicon/apple-touch-icon-120x120.png' %}">
    <link rel="apple-touch-icon" sizes="76x76" href="{% static 'favicon/apple-touch-icon-76x76.png' %}">
    <link rel="apple-touch-icon" sizes="152x152" href="{% static 'favicon/apple-touch-icon-152x152.png' %}">
    <link rel="icon" type="image/png" href="{% static 'favicon/favicon-96x96.png' %}" sizes="96x96">
    <link rel="icon" type="image/png" href="{% static 'favicon/favicon-16x16.png' %}" sizes="16x16">
    <link rel="icon" type="image/png" href="{% static 'favicon/favicon-32x32.png' %}" sizes="32x32">
    <meta name="msapplication-TileColor" content="#00aba9">
    <meta name="msapplication-TileImage" content="{% static 'favicon/mstile-144x144.png' %}">
    <meta name="msapplication-config" content="{% static 'favicon/browserconfig.xml' %}">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="{% static 'vendor/requirejs/require.js' %}"></script>

    <link rel="stylesheet" href="{% static 'css/normalize.css' %}">
    <link rel="stylesheet" href="{% static 'css/jquery.qtip.css' %}">
    <link rel="stylesheet" href="{% static 'css/animate.css' %}">
    <link rel="stylesheet" type="text/less" href="{% static 'css/less/style.less' %}">
    {# Components #}
    <link rel="stylesheet" type="text/less" href="{% static 'css/less/blocks/icon.less' %}">
    <link rel="stylesheet" type="text/less" href="{% static 'css/less/blocks/buttons/buttons.less' %}">
    <link rel="stylesheet" type="text/less" href="{% static 'css/less/blocks/dropdown/dropdown.less' %}">
    <link rel="stylesheet" type="text/less" href="{% static 'css/less/blocks/dropdown/dropdown_theme_menu-header.less' %}">

    <link rel="stylesheet" type="text/less" href="{% static 'css/less/blocks/site-logo/site-logo.less' %}">
    <link rel="stylesheet" type="text/less" href="{% static 'feedbacks/css/less/dj-feedback_theme_tourism.less' %}">

    {# Блок стилей (css, less) #}
    {% block styles %}
    {% endblock %}

    {% block head %}
    {% endblock %}

    <script src="{% static 'vendor/modernizr/modernizr.js' %}"></script>
</head>
<body class="{% block wrapper_class %}{% endblock %}{% if debug %} _debug{% endif %}">
    <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->


    <header class="b-page-header">
        {% block page-header %}
        {% endblock %}
    </header>


    <div class="content-wrapper">
        <div class="content">
            {% block content %}
            {% endblock %}

            {% block moderate %}
                <form id="moderation-form" method="POST">
                    {% csrf_token %}
                    <textarea name="reason"></textarea> <br />
                    <button name="approve">{% trans Approve %}</button>
                    <button name="reject">{% trans Reject %}</button>
                    <input type="hidden" id="approved" value="False"></input>
                </form>

                <script type="text/javascript">
                    require(['{% static "js/common.js" %}'], function() {
                        require(['{% static "js/utils.js" %}']);
                    });
                </script>
                <script type="text/javascript">
                    $(function() {
                        $('[name=approve]').click(function() {
                            $('#approved').val('True');
                        });
                        $('[name=reject]').click(function() {
                            $('#approved').val('False');
                        });
                        $('#moderation-form').submit(function(event) {
                            var fd = new FormData(this);
                            fd.append('approved', $('#approved').val());
                            $.ajax({
                                url: '',
                                type: 'POST',
                                data: fd,
                                processData: false,
                                contentType: false,
                                    {% comment %}
                                beforeSend: function(xhr, settings) {
                                    if (!utils.csrfSafeMethod(settings.type)) {
                                        xhr.setRequestHeader("X-CSRFToken", $.cookie('csrftoken'));
                                    }
                                },
                                {% endcomment %}
                                success: function (data, textStatus, jqXHR) {
                                    console.log(data);
                                    location.href = '{% url "moderator:pending-list" %}';
                                },
                                error: function(jqXHR, textStatus, errorThrown) {
                                   console.log(textStatus);
                                   console.log(jqXHR);
                                   console.log(errorThrown);
                                }
                            });

                            event.preventDefault();
                        });
                    });
                </script>
            {% endblock %}
        </div>
    </div>
</body>
</html>
